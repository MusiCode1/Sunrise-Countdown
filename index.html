<!DOCTYPE html>
<html dir="rtl" lang="he">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××•× ×” ×–××Ÿ ×¢×“ ×”×–×¨×™×—×”</title>

    <!-- Tailwind CSS - ×¡×¤×¨×™×™×ª CSS ×œ×¢×™×¦×•×‘ -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React - ×¡×¤×¨×™×™×ª JavaScript ×œ×™×¦×™×¨×ª ×××©×§ ××©×ª××© -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel - ×××™×¨ ×§×•×“ JavaScript ××•×“×¨× ×™ ×œ×§×•×“ ×ª×•×× ×“×¤×“×¤× ×™× ×™×©× ×™× -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lucide Icons - ×¡×¤×¨×™×™×ª ××™×™×§×•× ×™× -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <!-- ×©×•×¨×© ×”××¤×œ×™×§×¦×™×” -->
    <div id="root"></div>
    <script type="text/babel">
        // ============================================
        // ×§×‘×•×¢×™× ×•×–×× ×™×
        // ============================================

        // ×”×’×“×¨×ª ×–×× ×™ ×”×™×•× ×•×”×œ×™×œ×” ×”×§×‘×•×¢×™× ×‘××¢×¨×›×ª
        const NIGHT_START_HOUR = '19:00'; // ×©×¢×ª ×ª×—×™×œ×ª ×”×œ×™×œ×”
        const NIGHT_END_HOUR = '05:45';   // ×©×¢×ª ×¡×•×£ ×”×œ×™×œ×” (×–×¨×™×—×”)

        // ×”×’×“×¨×ª ×–××Ÿ ××•×ª×× ×œ×‘×“×™×§×•×ª (null ×œ×©×™××•×© ×‘×–××Ÿ ×××™×ª×™)
        const CUSTOM_TIME = ''; // ×œ×“×•×’××”: '01:30' ××• '06:30'

        // ============================================
        // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨
        // ============================================

        /**
         * ××—×©×‘×ª ××ª ×”×–××Ÿ ×©× ×•×ª×¨ ×¢×“ ×œ×–××Ÿ ×”×™×¢×“
         * @param {string} targetTime - ×–××Ÿ ×”×™×¢×“ ×‘×¤×•×¨××˜ "HH:MM"
         * @param {Date} currentDate - ×ª××¨×™×š ×•×©×¢×” × ×•×›×—×™×™×
         * @returns {string} ×”×–××Ÿ ×©× ×•×ª×¨ ×‘×¤×•×¨××˜ "HH:MM"
         */
        const calculateTimeLeft = (targetTime, currentDate) => {
            // ×”××¨×ª ×–××Ÿ ×”×™×¢×“ ×œ××¡×¤×¨×™×
            const [targetHour, targetMinute] = targetTime.split(':').map(Number);
            const currentHour = currentDate.getHours();
            const currentMinute = currentDate.getMinutes();

            // ×—×™×©×•×‘ ×”×©×¢×•×ª ×•×”×“×§×•×ª ×©× ×•×ª×¨×•
            let hoursLeft = targetHour - currentHour;
            let minutesLeft = targetMinute - currentMinute;

            // ×ª×™×§×•×Ÿ ×‘××§×¨×” ×©×œ ×“×§×•×ª ×©×œ×™×œ×™×•×ª
            if (minutesLeft < 0) {
                hoursLeft--;
                minutesLeft += 60;
            }

            // ×ª×™×§×•×Ÿ ×‘××§×¨×” ×©×œ ×©×¢×•×ª ×©×œ×™×œ×™×•×ª (××¢×‘×¨ ×œ×™×•× ×”×‘×)
            if (hoursLeft < 0) {
                hoursLeft += 24;
            }

            return `${hoursLeft}:${minutesLeft.toString().padStart(2, '0')}`;
        };

        // ============================================
        // ×§×•××¤×•× × ×˜×ª ×˜×™×™××¨ ×™×•×/×œ×™×œ×”
        // ============================================

        /**
         * ×§×•××¤×•× × ×˜×” ×¨××©×™×ª ×”××¦×™×’×” ×˜×™×™××¨ ×”××ª×¢×“×›×Ÿ ×‘×–××Ÿ ×××ª ×•××¨××”:
         * - ×”×× ×›×¨×’×¢ ×™×•× ××• ×œ×™×œ×”
         * - ×›××” ×–××Ÿ × ×•×ª×¨ ×¢×“ ×œ×–×¨×™×—×”/×©×§×™×¢×”
         * - ×¤×¨×•×’×¨×¡ ×‘×¨ ×”××¦×™×’ ××ª ×”×”×ª×§×“××•×ª ×‘××”×œ×š ×”×œ×™×œ×”
         * - ×©×¢×•×Ÿ ×‘×–××Ÿ ×××ª
         */
        const DayNightTimer = () => {
            // ============================================
            // ××¦×‘ (State) ×”×§×•××¤×•× × ×˜×”
            // ============================================
            const [progress, setProgress] = React.useState(0);                   // ××—×•×– ×”×”×ª×§×“××•×ª ×‘×œ×™×œ×” (0-100)
            const [timeLeft, setTimeLeft] = React.useState('');                  // ×–××Ÿ ×©× ×•×ª×¨ ×¢×“ ×œ××™×¨×•×¢ ×”×‘×
            const [isNight, setIsNight] = React.useState(false);                 // ×”×× ×›×¨×’×¢ ×œ×™×œ×”
            const [sleepTime, setSleepTime] = React.useState(NIGHT_START_HOUR);  // ×–××Ÿ ×”×©×™× ×”
            const [wakeupTime, setWakeupTime] = React.useState(NIGHT_END_HOUR);  // ×–××Ÿ ×”×§×™××”

            window.setProgress = setProgress;

            // ×¤×•× ×§×¦×™×” ×©××—×–×™×¨×” ××ª ×”×–××Ÿ ×”× ×•×›×—×™ ××• ××ª ×”×–××Ÿ ×”××•×ª×× ×× ××•×’×“×¨
            const getCurrentTime = () => {
                if (CUSTOM_TIME) {
                    const now = new Date();
                    const [hours, minutes] = CUSTOM_TIME.split(':').map(Number);
                    now.setHours(hours, minutes, 0, 0);
                    return now;
                }
                return new Date();
            };

            // ××¤×§×˜ ×¦×“ ×œ×”×ª×—×œ×ª ×”×˜×™×™××¨ ×•×”×ª×¦×•×’×”
            React.useEffect(() => {
                /**
                 * ××—×©×‘×ª ××ª ××—×•×– ×”×”×ª×§×“××•×ª ×©×œ ×”×œ×™×œ×” ×•××¢×“×›× ×ª ××ª ×”××¦×‘ ×‘×”×ª××
                 * ×›×•×œ×œ ×—×™×©×•×‘ ×”×–××Ÿ ×©× ×•×ª×¨ ×¢×“ ×œ×–×¨×™×—×”/×©×§×™×¢×” ×”×‘××”
                 */
                const calculateProgress = () => {
                    // ×§×‘×œ×ª ×”×–××Ÿ ×”× ×•×›×—×™
                    const now = getCurrentTime();
                    const currentHour = now.getHours();

                    // ×”××¨×ª ×–×× ×™ ×”×©×™× ×” ×•×”×§×™××” ×œ××¡×¤×¨×™×
                    const [sleepHour, sleepMinute] = sleepTime.split(':').map(Number);
                    const [wakeHour, wakeMinute] = wakeupTime.split(':').map(Number);

                    // ×‘×“×™×§×” ×”×× ×¢×›×©×™×• ×œ×™×œ×”
                    // ××¦×‘ ×œ×™×œ×” ××•×’×“×¨ ×›××©×¨:
                    // 1. ×”×©×¢×” ×’×“×•×œ×” ××©×¢×ª ×”×©×™× ×”
                    // 2. ××• ×”×©×¢×” ×©×•×•×” ×œ×©×¢×ª ×”×©×™× ×” ×•×”×“×§×•×ª ×’×“×•×œ×•×ª/×©×•×•×ª
                    // 3. ××• ×”×©×¢×” ×§×˜× ×” ××©×¢×ª ×”×§×™××”
                    // 4. ××• ×”×©×¢×” ×©×•×•×” ×œ×©×¢×ª ×”×§×™××” ×•×”×“×§×•×ª ×§×˜× ×•×ª
                    const night = (currentHour > sleepHour || (currentHour === sleepHour && now.getMinutes() >= sleepMinute)) ||
                        (currentHour < wakeHour || (currentHour === wakeHour && now.getMinutes() < wakeMinute));
                    setIsNight(night);

                    if (night) {
                        // ×—×™×©×•×‘ ×–×× ×™ ×©×§×™×¢×” ×•×–×¨×™×—×”
                        const sunset = new Date(now);
                        const sunrise = new Date(now);

                        sunset.setHours(sleepHour, sleepMinute, 0);
                        sunrise.setHours(wakeHour, wakeMinute, 0);

                        // ×ª×™×§×•×Ÿ ×”×ª××¨×™×š ×× × ×“×¨×©
                        if (currentHour < 6) {
                            sunset.setDate(sunset.getDate() - 1);  // ×”×©×§×™×¢×” ×”×™×™×ª×” ××ª××•×œ
                        } else {
                            sunrise.setDate(sunrise.getDate() + 1); // ×”×–×¨×™×—×” ×ª×”×™×” ××—×¨
                        }

                        // ×—×™×©×•×‘ ×”×”×ª×§×“××•×ª ×‘××—×•×–×™×
                        const nightDuration = sunrise - sunset;
                        const elapsed = now - sunset;
                        const newProgress = Math.min(100, Math.max(0, (elapsed / nightDuration) * 100));

                        setProgress(newProgress);
                        setTimeLeft(calculateTimeLeft(wakeupTime, now));

                    } else {
                        // ×‘×™×•×: ××™×Ÿ ×”×ª×§×“××•×ª ×•××—×©×‘×™× ×–××Ÿ ×¢×“ ×”×œ×™×œ×”
                        setProgress(0);
                        setTimeLeft(calculateTimeLeft(NIGHT_START_HOUR, now));
                    }


                };

                // ×”×¤×¢×œ×” ×¨××©×•× ×™×ª ×•×§×‘×™×¢×ª ××™× ×˜×¨×•×•×œ ×œ×¢×“×›×•×Ÿ ×›×œ ×“×§×”
                calculateProgress();
                const interval = setInterval(calculateProgress, 60000);

                // ××ª×—×•×œ ×”××™×™×§×•× ×™×
                lucide.createIcons();

                // × ×™×§×•×™ ×‘×¢×ª ×”×¡×¨×ª ×”×§×•××¤×•× × ×˜×”
                return () => clearInterval(interval);
            }, []);

            // ××ª×—×•×œ ×”××™×™×§×•× ×™× ××—×¨×™ ×›×œ ×¨×™× ×“×•×¨
            React.useEffect(() => {
                lucide.createIcons();
            });

            // ×¦×‘×¢×™ ×¨×§×¢ ×•×˜×§×¡×˜ ×‘×”×ª×× ×œ××¦×‘ ×™×•×/×œ×™×œ×”
            const bgColor = isNight ? 'bg-slate-900' : 'bg-sky-100';
            const textColor = isNight ? 'text-white' : 'text-slate-900';

            // ============================================
            // ×¨×™× ×“×•×¨ ×”×××©×§
            // ============================================
            return (
                <div className="h-screen w-full flex items-center justify-center p-4 bg-gradient-to-b from-slate-800 to-slate-900 overflow-hidden">
                    <div className={`${bgColor} rounded-xl shadow-xl transition-all duration-1000 w-full max-w-2xl`}>
                        <div className="p-8">
                            <div className="flex flex-col items-center space-y-4">
                                {/* ×ª××•× ×ª ××¦×‘ ×™×•×/×œ×™×œ×” */}
                                <div className="bg-white p-3 rounded-2xl flex flex-col items-center aspect-square">
                                    <img
                                        src={isNight ? 'bed.png' : 'morning.png'}
                                        alt={isNight ? '×œ×™×œ×”' : '×‘×•×§×¨'}
                                        className="h-[11vh] w-[11vh] object-contain transition-all duration-1000"
                                    />
                                    <div className="text-slate-900 text-[3vh] font-bold mt-2">
                                        {'×¢×›×©×™×• ' + (isNight ? '×œ×™×œ×”' : '×™×•×')}
                                    </div>
                                </div>

                                {/* ×›×•×ª×¨×ª ×“×™× ××™×ª */}
                                <h2 className={`text-[4vh] font-bold ${textColor} transition-all duration-1000 text-center`}>
                                    {isNight ? '×–××Ÿ ×¢×“ ×”×–×¨×™×—×”' : '×–××Ÿ ×¢×“ ×”×œ×™×œ×”'}
                                </h2>

                                {/* ××™×›×œ ×”×¤×¨×•×’×¨×¡ ×‘×¨ */}
                                <div className="w-full bg-slate-900/40 backdrop-blur-sm rounded-2xl h-[15vh] border-2 border-slate-600 shadow-lg p-4">
                                    {/* ×¨×§×¢ ×–×›×•×›×™×ª×™ */}
                                    <div className="absolute inset-0 rounded-2xl bg-gradient-to-b from-slate-800/50 to-slate-900/50"></div>

                                    {/* ××™×›×œ ×¤×œ×§×¡ ×œ××™×™×§×•× ×™× ×•×”×¤×¨×•×’×¨×¡ ×‘×¨ */}
                                    <div className="relative z-10 flex items-center justify-between h-full">
                                        {/* ××™×™×§×•×Ÿ ×™×¨×— */}
                                        <div className="flex-shrink-0">
                                            <i data-lucide="moon" className="w-8 h-8 text-blue-200 transform transition-transform hover:scale-110 duration-300 animate-pulse drop-shadow-lg"></i>
                                        </div>

                                        {/* ×”×¤×¨×•×’×¨×¡ ×‘×¨ ×¢×¦××• */}
                                        <div className="h-[8vh] bg-slate-800 rounded-xl border border-slate-600 mx-3 flex-1">
                                            {/* ×”×¤×¨×•×’×¨×¡ ×¢× ×× ×™××¦×™×” */}
                                            <div
                                                className="h-full rounded-xl transition-all duration-1000 bg-gradient-to-r from-blue-500/90 via-blue-600/90 to-blue-700/90 shadow-[0_0_20px_rgba(37,99,235,0.4)] relative"
                                                style={{ width: `${progress}%` }}
                                            >
                                                {/* ××¤×§×˜ ×–×•×”×¨ ×‘×§×¦×•×•×ª */}
                                                <div className="absolute inset-0 rounded-xl bg-gradient-to-r from-transparent via-blue-400/20 to-transparent"></div>

                                                {/* ××—×•×–×™ ×”×ª×§×“××•×ª (××•×¦×’ ×¨×§ ×‘×œ×™×œ×” ×•××¢×œ 13%) */}
                                                {(isNight && progress > 13) ? <div className="absolute left-3 top-1/2 -translate-y-1/2 text-blue-200 text-[3.5vh] font-bold px-2">
                                                    {Math.round(progress)}%
                                                </div> : ''}
                                            </div>
                                        </div>

                                        {/* ××™×™×§×•×Ÿ ×©××© */}
                                        <div className="flex-shrink-0">
                                            <i data-lucide="sun" className="w-8 h-8 text-yellow-600 transform transition-transform hover:scale-110 duration-300 drop-shadow-lg"></i>
                                        </div>
                                    </div>
                                </div>

                                {/* ×ª×¦×•×’×ª ×–××Ÿ ×©× ×•×ª×¨ */}
                                <div className={`text-[2.5vh] font-bold ${textColor} transition-all duration-1000 text-center flex flex-col gap-2`}>
                                    × ×•×ª×¨×• {timeLeft}
                                </div>

                                {/* ×©×¢×•×Ÿ ×‘×–××Ÿ ×××ª */}
                                <div className={`${textColor} font-bold text-[5vh] bg-slate-800/30 backdrop-blur-sm rounded-xl px-4 py-2 border border-slate-600/50 shadow-lg inline-flex items-center gap-3 mx-auto`}>
                                    <i data-lucide="clock" className="w-[5vh] h-[5vh] text-blue-200"></i>
                                    {getCurrentTime().toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' })}
                                </div>

                                {/* ×”×ª×¨××” ×¢×œ ×–××Ÿ ××•×ª×× */}
                                {CUSTOM_TIME && (
                                    <div className={`text-[2vh] ${textColor} transition-all duration-1000 text-center mt-2`}>
                                        âš ï¸ ××¦×‘ ×‘×“×™×§×”: ×”×©×¢×” ×”×•×’×“×¨×” ×™×“× ×™×ª ×œ-{CUSTOM_TIME}
                                    </div>
                                )}

                                {/* ×‘×¨×›×ª ×™×•×/×œ×™×œ×” */}
                                <div className={`text-[3vh] ${textColor} transition-all duration-1000 text-center`}>
                                    {(isNight ? 'ğŸŒ™ ×œ×™×œ×” ×˜×•×‘' : 'â˜€ï¸ ×™×•× ×˜×•×‘') + '!'}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // ×”×¨×¦×ª ×”××¤×œ×™×§×¦×™×”
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<DayNightTimer />);

    </script>
</body>

</html>
